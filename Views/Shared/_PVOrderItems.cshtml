@model NhomProject.Models.Order
@using System.Globalization

@{
    var vnFormat = new CultureInfo("vi-VN");
    vnFormat.NumberFormat.NumberDecimalDigits = 0;
    vnFormat.NumberFormat.NumberGroupSeparator = ".";

    var displayList = new List<dynamic>();

    if (Model.OrderDetails != null && Model.OrderDetails.Count > 0)
    {
        foreach (var item in Model.OrderDetails)
        {
            displayList.Add(new
            {
                Name = item.Product != null ? item.Product.Name : "Sản phẩm đã xóa",
                Img = item.Product != null ? item.Product.MainImageUrl : "",
                Qty = item.Quantity,
                Price = item.UnitPrice,
                Id = item.ProductId 
            });
        }
    }
    else if (Model.CartItems != null && Model.CartItems.Count > 0)
    {
        foreach (var item in Model.CartItems)
        {
            displayList.Add(new
            {
                Name = item.ProductName,
                Img = item.ImageUrl,
                Qty = item.Quantity,
                Price = item.Price,
                Id = item.ProductId
            });
        }
    }
}

<div class="table-responsive">
    <table class="table table-bordered">
        <thead class="bg-light">
            <tr>
                <th>Sản phẩm</th>
                <th class="text-center">Số lượng</th>
                <th class="text-end">Đơn giá</th>
                <th class="text-end">Thành tiền</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var item in displayList)
            {
                <tr>
                    <td>
                        <div class="d-flex align-items-center">
                            <img src="@Url.Content(item.Img ?? "https://placehold.co/50")"
                                 style="width: 60px; height: 60px; object-fit: cover; margin-right: 15px; border: 1px solid #ddd;" />
                            <div>
                                <a href="@Url.Action("Details", "Home", new { id = item.Id, area = "" })" style="text-decoration: none; color: #333; font-weight: bold;">
                                    @item.Name
                                </a>
                            </div>
                        </div>
                    </td>
                    <td class="text-center align-middle">@item.Qty</td>
                    <td class="text-end align-middle">@item.Price.ToString("N0", vnFormat) ₫</td>
                    <td class="text-end align-middle">@((item.Price * item.Qty).ToString("N0", vnFormat)) ₫</td>
                </tr>
            }
        </tbody>
        <tfoot>
            <tr class="bg-light">
                <td colspan="3" class="text-end fw-bold">TỔNG CỘNG:</td>
                <td class="text-end fw-bold text-danger">@Model.Total.ToString("N0", vnFormat) ₫</td>
            </tr>
        </tfoot>
    </table>
</div>