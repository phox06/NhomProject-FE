@model List<NhomProject.Models.ViewModel.CategoryStatisticVM>
@{
    ViewBag.Title = "Admin Dashboard";
    Layout = "~/Areas/Admin/Views/Shared/_AdminLayout.cshtml";
}

<!-- 1. THE STATISTICS TABLE -->
<h2 class="bg-success" style="padding:10px; color:white;">THỐNG KÊ HÀNG HÓA TỪNG LOẠI</h2>
<table class="table table-bordered table-striped">
    <tr class="bg-success" style="color:white;">
        <th>
            LOẠI HÀNG
        </th>
        <th>
            SỐ LƯỢNG
        </th>
        <th>
            GIÁ CAO NHẤT
        </th>
        <th>
            GIÁ THẤP NHẤT
        </th>
        <th>
            GIÁ TRUNG BÌNH
        </th>
    </tr>

    @foreach (var item in Model)
    {
        <tr>
            <td>@Html.DisplayFor(modelItem => item.CategoryName)</td>
            <td>@Html.DisplayFor(modelItem => item.ProductCount)</td>
            <td>@item.HighestPrice.ToString("N0") VNĐ</td>
            <td>@item.LowestPrice.ToString("N0") VNĐ</td>
            <td>@item.AveragePrice.ToString("N2") VNĐ</td>
        </tr>
    }
</table>

<hr />

<!-- 2. THE GOOGLE PIE CHART -->
<h2 class="bg-success" style="padding:10px; color:white;">BIỂU ĐỒ THỐNG KÊ</h2>

<!-- This is the div where the chart will be drawn -->
<div id="piechart_div" style="width: 100%; height: 500px;"></div>

<!-- Google Chart Library -->
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript">

    // Load the Google Visualization API and the corechart package.
    google.load('visualization', '1.0', { 'packages': ['corechart'] });

    // Set a callback to run when the API is loaded.
    google.setOnLoadCallback(drawChart);

    // Callback function that creates and populates the data table
    function drawChart() {

        // Create the data table.
        var data = new google.visualization.DataTable();
        data.addColumn('string', 'Loại hàng');
        data.addColumn('number', 'Số lượng');

        // Add data rows from our C# Model
        data.addRows([
            @foreach(var item in Model)
            {
                // Format: ['Category Name', ProductCount],
                <text>['@item.CategoryName', @item.ProductCount],</text>
            }
        ]);

        // Set chart options
        var options = {
            'title': 'TỶ LỆ HÀNG HÓA',
            'width': '100%',
            'height': '100%',
            'chartArea': {'width': '90%', 'height': '80%'},
            'legend': {'position': 'right'}
        };

        // Instantiate and draw our chart, passing in options.
        var chart = new google.visualization.PieChart(document.getElementById('piechart_div'));
        chart.draw(data, options);
    }
</script>